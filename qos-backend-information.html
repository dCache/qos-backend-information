<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../promise-polyfill/promise-polyfill-lite.html">
<script src="../util-precondition/precondition.js"></script>
<script src="../util-majax-requests/majax-requests-polymer-v1.js"></script>

<!--
`qos-backend-information`

@demo demo/index.html 
-->

<script>
  'use strict';
  Polymer({
    is: 'qos-backend-information',
    hostAttributes: {
      hidden: true
    },
    properties: {
      urls: {
        type: Array,
        value: [],
        notify: true
      },
      auth: {
        type: String,
        value: function() {
          return sessionStorage.upauth==undefined ? 
            'bm9ib2R5Om5vcGFzc3dvcmQ=': sessionStorage.upauth;
        },
        notify: true
      },
      response: {
        type: Array,
        value: [],
        notify: true
      }
    },

    getSiteBackendCapabilities: function()
    {
      try {
        precondition.checkArgument(this.urls != undefined || this.urls != null, 
          'Property \'urls\' cannot be unspecified.');
        precondition.checkArgument(this.urls.length != 0, 
          'Cannot set property \'urls\' to empty array.');
        let requestQosInfo = new MultipleAjaxRequests(this.urls, this.auth, this);
        this.addEventListener('allResolved', e => {
          this.response = e.detail;
        });
        requestQosInfo.send();
      } catch (e) {
        throw new Error(e.message);
      }
    }
  });
</script>